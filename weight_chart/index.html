<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Weight Tracker - Track Your Body Weight Progress</title>
  <meta name="description" content="Simple body weight tracking tool with visual charts. Track your weight progress over time with easy daily input. All data is stored locally in your browser - nothing is uploaded to any server.">
  <meta name="keywords" content="weight tracker, body weight, weight loss, fitness tracker, weight chart, daily weight">
  
  <!-- Mobile friendly -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAtGVYSWZJSSoACAAAAAYAEgEDAAEAAAABAAAAGgEFAAEAAABWAAAAGwEFAAEAAABeAAAAKAEDAAEAAAACAAAAEwIDAAEAAAABAAAAaYcEAAEAAABmAAAAAAAAAEgAAAABAAAASAAAAAEAAAAGAACQBwAEAAAAMDIxMAGRBwAEAAAAAQIDAACgBwAEAAAAMDEwMAGgAwABAAAA//8AAAKgBAABAAAAMAAAAAOgBAABAAAAMAAAAAAAAAANg05RAAAI1UlEQVR4nM1Ze4xcVRn//c6dfXS30Me29jU7d15s0SK2VgQUQQRBEo0aIBXTgDG0UYIYROILUUEwkSCQaizKG2IQQsEYKmKkPEIRocT6WFt2XvfuFqEPyvJo2Z255zNntjs7d+beeTTT6O+Pm3vO+c53vt+553znO98lOoh4PL7c0viWEGdDZAGJ7SLy7ZzrPoEjBHZKUSoeXwPBnQBmVdeLSJHEWVnHeRL/rwTStr1KC54n2RXULsBLOaewuh2dtm33RkRdDMpJgOzyyDsKhcLOI0Igadt3E7ywkYzyStGRsbFdrS5FpfEwiff6viTk8qzr/sKnFx0AgSXNZErsSraia8mSJX1K8Gi18eUxzNel2pCOJc7vOAERPt1UKIKJVnTN6u5eQyAV0kxNuek0o61dAul0euGxS5cOBLUdLE78DIIdQW0i8jwEF+bz+b+2NJDw/Y2aCSwbHUyubIeASsUSl0qxuGLHK6/sCxLo7++PCMS3wQTYqhVPzLnOSVm3cC9ahn4UwIGGBrFUabcaCZoZnzN/4B6l8GDGcZ4N80Di6adAHkeNdWXbKY/39vevHRkZcdEm9o+P5+cNzL8NWt4E5GMka2yUF7Oue31TLxSNRuf3WNZjWqvv5UfzfwqSScQSZxJ6E8mjKPrijOvejQ4iGYtfRuKWiunAPiX61IzrDjdcQmaTdFuR3wPYHGp8NHECqR82xgPyz4zr3oEOI+cWNojI42ZdAXjCEv3hauMNKru5GmO2/QOKLGR310+C2m3bnlueeXC2KWvgpqkJ6jgk5zpnp9PpnkwmE+jF6gjYtn0swO8IZV02rJPwRhDRqSHwhiZ+gyOITIgdgUvIAq4RyMFJz7s/qENyWfIYoVROXQGedBznXfyPoKoL8XjcJngehY+PjY0dDOpAS19OcObLCY5IkNYqfEtIaXwBBIXyQtjmHoWcx2rnRf1ikOzy5cuPKh2cXCOQxQp6U+3m6xRUTflz5iEiI0HCTjy+guRCnwKRV2vlktHkccWD7/4LlF+TuFagtqVs++Rmxhy/aFF/ExGGEli9enUXIKumStZ4UG8l0+0zsPr6dleXjceg8h4iOVg1bC+AH4VZlYglzkza8V3v9M56K2nbD4YRSUQTH0omk+8JJDC+d+9xJHvKlUrCTujFaIZi8RKQQ7XVAtSRN0gmkzFCP0RgaTnoBM97u6d3E4KgsAhFfYG/6hA8Ucum30VkXqAC4dG1Vd6BA74Z0cKzAvsCW4MqWdJfJf16SZ6Vsu1P1ckqGaDCJwMJWMDciiD8sXgV6oIsDxFfnM+gA03wBiORSwM1UnxX0Jk+XFNXp/EBiJxSvRcqBATSV3kXnBikU1Jerxtf6c/4bcXffGWRolC+mM1mRwPt7+q6GiK7A4hF6+twIsg5x0SjS+sJ0ER/FZxuwoU6BaL21I/D85PJ5Jzpcpd4P4dIOQoVkQkK1+Yc5w8IQSaTeVPA+iBQ6CO8fHBwKUROMO/asobqCJDcX/XebWleVKtTU79TNxCxGJ53w3Rx5+joKxPaWyWQc5XoFdnRwgNohojaKJCS3355sLpcUmr9dNKAohbUEUDJyvoNkyui0ahvfVJY2eh+DlyXsu1rp9fm2NjY6znH2ZQZHfXrDEEul3MJ/PBQQOiJ4Lrqr5ZKpQYh/PpMD+/oOgLZsWwWIhX/b/x4j4pcXTMr5U8YDF6VisUfMrFSUKsxIhVNpc09I+hAyjrOdUXRyyK9PfNybuGq6nNFit7d4IyT0aSuIzC1d/lcjcHfTNn2xysmgu8LJ1AW+DwjekcqFt+cisc/O33jK+soeQ4sb6THiuxL2fF9Sdu+19yzq7u7rvufnTt3vjVdNmT1ZPGPJE6vllNa7Q0iAFKe8dvDiAgeCJvVECgQ50DwSMq2HytPhGUNC+TeqnU+j+BaXSyeG6RgaMnQgpRtX9FtRV4meVptuyi9N/g+oJmpjY5M7CMRvSWRSHxCtP43wY+2zoVnDMViiZdzuTyAixKDiduo5BENuVIDmx3HebW8RCZL60FJQbgQlCEPkx80DjrsvkutdwcSEAuzKMGpDGjZSuC21o2f6loCN6YHBy+R7u5JPal7teiL8q67+dA1EVIs/hTkZeVR2FKy8GBmdLQQSAAe5oYlWggMALyyTQLlsEBTPYlS6TlFrARVOhmLm8PuLlKSAL/WpkoTlnshe2BqVhrgcDN5i0Xkd1nXGYo6hW6xeA6JU4Gya2wvPyv4R3XR/wVo7gEdy7jPqAUjJO9LxezvjxEj1Nrcu9OHp0zCCYhlvURPe80SXocNcrmJCmiCVsFfCFkKMtaWipqo1rckcrmc2d1P4YhDrsy5hZOLkJXVh2cL2J9xnBcar2lBYDYiAH9uY+AZ9SITPQf6f2XeXdfdD/DZ1jtjS/UGDiQwoUv3QeS1ZroovFWA+uCuWT/AGd4z/HbFJtaH6GEQBZOlQ0MC5XRKVT4yDB68bgo2oH28UVPubbGfaKB8sjd1ixOed7NAMo20EWrVhC7d0OYaNhvZ7yAER7XSTUSeLhQKTksEzFcgsL42Rq9ReYoJmwW8sRUDZgxB5eZnwFYSBVOu+Pa2Dqas42whubbBz4ZVJtHVNavnZhGpu6mFGmIuQP6KWLM+IjI6d+HA/W2frNlC4bclyAoINkIwk8AqLxte/xRQMuEvoa5plYCJRKd/VaXTaXMxCc6A+IxUV2zbtq0Y1NbWsWsSTm/19c3O5/NmxnV1Umz/nn3ba/8shkFEfzrnuo8mEonjlZbtjYVxZ9YtfLkjsc3fX3vtnXw+b1ysL2Yys0Poi2vrw6E+Yp5WCXYjKYHc0zO77ysNNaFDyLruVkB+3JIwp3KwoJcNdBQi44R8I+c4XxoeHp5srKqzYNK272r2197AI1YWCoXtyVjsDEKtBWUBhLtF4WkViTxs0i0tDdgRs2t0pmz7uxBedSipGwiBXJBznFbDllAckahz//j4M/MXDNwjnphcEwmTPiz/FCkJpQDhrb2z+3+5Z88eX1xzOPgve3+OCY7TuLQAAAAASUVORK5CYII=">
  
  <!-- Chart.js for data visualization - loaded asynchronously -->
  <script>
    // Load Chart.js asynchronously to prevent blocking page render
    window.chartJsLoaded = false;
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/chart.js';
    script.onload = function() {
      window.chartJsLoaded = true;
      console.log('Chart.js loaded asynchronously');
      if (window.initChart) {
        window.initChart();
      }
    };
    document.head.appendChild(script);
  </script>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: #ffffff;
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.08);
      border: 1px solid #e0f2fe;
    }
    
    h1 {
      text-align: center;
      color: #0f172a;
      margin-bottom: 10px;
      font-weight: 500;
      font-size: 2.5rem;
    }
    
    .tagline {
      text-align: center;
      color: #64748b;
      font-size: 16px;
      margin-bottom: 30px;
      font-style: italic;
    }
    
    .quick-input {
      background: #f8fafc;
      padding: 25px;
      border-radius: 12px;
      margin-bottom: 30px;
      border: 1px solid #e2e8f0;
      text-align: center;
    }
    
    .quick-input h3 {
      color: #1e293b;
      margin-bottom: 20px;
      font-size: 18px;
      font-weight: 500;
    }
    
    .weight-input-group {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 15px;
      flex-wrap: wrap;
    }
    
    .weight-input {
      padding: 15px 20px;
      border: 2px solid #cbd5e0;
      border-radius: 10px;
      font-size: 24px;
      font-weight: 600;
      text-align: center;
      width: 150px;
      background: #ffffff;
      transition: all 0.3s ease;
    }
    
    .weight-input:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }
    
    .unit-selector {
      display: flex;
      gap: 10px;
    }
    
    .unit-btn {
      padding: 8px 16px;
      border: 2px solid #e2e8f0;
      background: #ffffff;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
    }
    
    .unit-btn.active {
      background: #3b82f6;
      color: white;
      border-color: #3b82f6;
    }
    
    .add-btn {
      background: linear-gradient(45deg, #10b981, #059669);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 10px;
      font-size: 18px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .add-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }
    
    .stat-card {
      background: #f8fafc;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      border: 1px solid #e2e8f0;
    }
    
    .stat-value {
      font-size: 24px;
      font-weight: bold;
      color: #1e293b;
      margin-bottom: 5px;
    }
    
    .stat-label {
      font-size: 14px;
      color: #64748b;
    }
    
    .chart-container {
      background: #ffffff;
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 30px;
      border: 1px solid #e2e8f0;
      height: 400px;
      position: relative;
    }
    
    .loading-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.9);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      border-radius: 12px;
      z-index: 10;
    }
    
    .loading-spinner {
      width: 40px;
      height: 40px;
      border: 4px solid #e2e8f0;
      border-top: 4px solid #3b82f6;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 15px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .loading-text {
      color: #64748b;
      font-size: 14px;
      font-weight: 500;
    }
    
    .recent-entries {
      background: #f8fafc;
      padding: 20px;
      border-radius: 12px;
      border: 1px solid #e2e8f0;
    }
    
    .recent-entries h3 {
      color: #1e293b;
      margin-bottom: 15px;
      font-size: 18px;
      font-weight: 500;
    }
    
    .entry-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
      border-bottom: 1px solid #e2e8f0;
    }
    
    .entry-item:last-child {
      border-bottom: none;
    }
    
    .entry-date {
      font-weight: 500;
      color: #374151;
    }
    
    .entry-weight {
      font-weight: bold;
      color: #1e293b;
    }
    
    .entry-change {
      font-size: 14px;
      padding: 4px 8px;
      border-radius: 6px;
    }
    
    .entry-change.positive {
      background: #fee2e2;
      color: #dc2626;
    }
    
    .entry-change.negative {
      background: #dcfce7;
      color: #16a34a;
    }
    
    .entry-change.neutral {
      background: #f1f5f9;
      color: #64748b;
    }
    
    .delete-btn {
      background: #ef4444;
      color: white;
      border: none;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      cursor: pointer;
      opacity: 0.7;
      transition: opacity 0.3s ease;
    }
    
    .delete-btn:hover {
      opacity: 1;
    }
    
    .empty-state {
      text-align: center;
      color: #64748b;
      padding: 40px 20px;
      font-size: 16px;
    }
    
    .empty-state-icon {
      font-size: 48px;
      margin-bottom: 15px;
      opacity: 0.5;
    }
    
    /* Settings Button */
    .settings-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 56px;
      height: 56px;
      background: #3b82f6;
      border: none;
      border-radius: 50%;
      color: white;
      font-size: 20px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
      transition: all 0.3s ease;
      z-index: 1000;
    }
    
    .settings-btn:hover {
      background: #2563eb;
      transform: scale(1.1);
      box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
    }
    
    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 2000;
      justify-content: center;
      align-items: center;
    }
    
    .modal-content {
      background: white;
      border-radius: 15px;
      padding: 30px;
      max-width: 400px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      position: relative;
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 1px solid #e2e8f0;
    }
    
    .modal-title {
      font-size: 24px;
      font-weight: 600;
      color: #1e293b;
      margin: 0;
    }
    
    .close-btn {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #64748b;
      padding: 0;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .close-btn:hover {
      color: #1e293b;
    }
    
    .modal-section {
      margin-bottom: 25px;
    }
    
    .modal-section:last-child {
      margin-bottom: 0;
    }
    
    .section-title {
      font-size: 16px;
      font-weight: 600;
      color: #374151;
      margin-bottom: 10px;
    }
    
    .section-description {
      font-size: 14px;
      color: #6b7280;
      margin-bottom: 15px;
    }
    
    .modal-btn {
      background: #3b82f6;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.2s;
      width: 100%;
      margin-bottom: 10px;
    }
    
    .modal-btn:hover {
      background: #2563eb;
    }
    
    .modal-btn.danger {
      background: #ef4444;
    }
    
    .modal-btn.danger:hover {
      background: #dc2626;
    }
    
    .modal-btn:last-child {
      margin-bottom: 0;
    }
    
    /* Mobile responsive */
    @media (max-width: 768px) {
      body {
        padding: 10px;
      }
      
      .container {
        padding: 20px;
      }
      
      h1 {
        font-size: 2rem;
      }
      
      .weight-input-group {
        flex-direction: column;
        align-items: center;
      }
      
      .weight-input {
        width: 100%;
        max-width: 200px;
      }
      
      .chart-container {
        height: 300px;
        padding: 15px;
      }
      
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>⚖️ Weight Tracker</h1>
    <p class="tagline">
      Track your body weight progress with simple daily input<br>
      Your data stays private in your browser
    </p>
    
    <!-- Quick Input -->
    <div class="quick-input">
      <h3>Today's Weight</h3>
      <div class="weight-input-group">
        <input type="number" 
               id="weightInput" 
               class="weight-input" 
               placeholder="0.0" 
               step="0.1" 
               min="0" 
               max="1000">
        
        <div class="unit-selector">
          <button class="unit-btn active" data-unit="kg">kg</button>
          <button class="unit-btn" data-unit="lbs">lbs</button>
        </div>
        
        <button class="add-btn" onclick="addWeight()">Add Entry</button>
      </div>
    </div>
    
    <!-- Stats -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-value" id="currentWeight">--</div>
        <div class="stat-label">Current Weight</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="startWeight">--</div>
        <div class="stat-label">Starting Weight</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="totalChange">--</div>
        <div class="stat-label">Total Change</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="totalEntries">0</div>
        <div class="stat-label">Total Entries</div>
      </div>
    </div>
    
    <!-- Chart -->
    <div class="chart-container">
      <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading Chart...</div>
      </div>
      <div id="chartEmptyState" class="empty-state" style="display: none;">
        <div class="empty-state-icon">📈</div>
        <p><strong>Your weight chart will appear here</strong></p>
        <p style="margin-top: 10px; font-size: 14px; opacity: 0.8;">Add your first weight entry above to start tracking your progress!</p>
      </div>
      <canvas id="weightChart" style="display: none;"></canvas>
    </div>
    
    <!-- Recent Entries -->
    <div class="recent-entries">
      <h3>Recent Entries</h3>
      <div id="entriesList">
        <div class="empty-state">
          <div class="empty-state-icon">📊</div>
          <p>No weight entries yet. Add your first weight above!</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Settings Button -->
  <button class="settings-btn" onclick="openSettings()" title="Settings">
    ⚙️
  </button>

  <!-- Settings Modal -->
  <div id="settingsModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">Settings</h2>
        <button class="close-btn" onclick="closeSettings()">&times;</button>
      </div>
      
      <div class="modal-section">
        <div class="section-title">Export Data</div>
        <div class="section-description">Download your weight data as a CSV file for backup or analysis.</div>
        <button class="modal-btn" onclick="exportData()">📥 Export CSV</button>
      </div>
      
      <div class="modal-section">
        <div class="section-title">Clear Data</div>
        <div class="section-description">Permanently delete all your weight entries. This action cannot be undone.</div>
        <button class="modal-btn danger" onclick="clearAllData()">🗑️ Clear All Data</button>
      </div>
    </div>
  </div>

  <script>
    let weightEntries = [];
    let currentUnit = 'kg';
    let chart = null;

    // Settings Modal Functions
    function openSettings() {
      const modal = document.getElementById('settingsModal');
      modal.style.display = 'flex';
      document.body.style.overflow = 'hidden';
    }

    function closeSettings() {
      const modal = document.getElementById('settingsModal');
      modal.style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    function exportData() {
      if (weightEntries.length === 0) {
        alert('No data to export!');
        return;
      }
      
      let csv = 'Date,Weight,Unit,Change\n';
      
      weightEntries.forEach((entry, index) => {
        let change = '';
        if (index > 0) {
          const prevEntry = weightEntries[index - 1];
          const weightChange = entry.weight - prevEntry.weight;
          change = weightChange > 0 ? `+${weightChange.toFixed(1)}` : weightChange.toFixed(1);
        }
        csv += `${entry.date},${entry.weight},${entry.unit},"${change}"\n`;
      });
      
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `weight-tracker-${new Date().toISOString().split('T')[0]}.csv`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      window.URL.revokeObjectURL(url);
      
      alert('Data exported successfully!');
    }

    function clearAllData() {
      if (confirm('Are you sure you want to clear all weight data? This action cannot be undone.')) {
        weightEntries = [];
        localStorage.removeItem('weightTracker');
        updateStats();
        updateChart();
        updateEntriesList();
        closeSettings();
        alert('All data has been cleared.');
      }
    }

    // Close modal when clicking outside
    document.getElementById('settingsModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeSettings();
      }
    });

    // Load data from localStorage
    function loadData() {
      const stored = localStorage.getItem('weightTracker');
      const storedUnit = localStorage.getItem('weightTrackerUnit');
      
      if (stored) {
        weightEntries = JSON.parse(stored);
        updateStats();
        updateEntriesList();
      }
      
      if (storedUnit) {
        currentUnit = storedUnit;
        updateUnitButtons();
      }
    }

    // Save data to localStorage
    function saveData() {
      localStorage.setItem('weightTracker', JSON.stringify(weightEntries));
      localStorage.setItem('weightTrackerUnit', currentUnit);
    }

    // Add weight entry
    function addWeight() {
      const weightInput = document.getElementById('weightInput');
      const weight = parseFloat(weightInput.value);

      if (!weight || weight <= 0) {
        alert('Please enter a valid weight!');
        return;
      }

      const today = new Date().toISOString().split('T')[0];
      
      // Check if entry for today already exists
      const existingIndex = weightEntries.findIndex(entry => entry.date === today);
      
      if (existingIndex !== -1) {
        if (confirm('You already have an entry for today. Do you want to update it?')) {
          weightEntries[existingIndex] = {
            date: today,
            weight: weight,
            unit: currentUnit,
            timestamp: new Date().toISOString()
          };
        } else {
          return;
        }
      } else {
        weightEntries.push({
          date: today,
          weight: weight,
          unit: currentUnit,
          timestamp: new Date().toISOString()
        });
      }

      // Sort entries by date
      weightEntries.sort((a, b) => new Date(a.date) - new Date(b.date));

      saveData();
      updateStats();
      updateChart();
      updateEntriesList();
      
      // Clear input
      weightInput.value = '';
      
      // Show success feedback
      const btn = document.querySelector('.add-btn');
      const originalText = btn.textContent;
      btn.textContent = '✓ Added!';
      btn.style.background = 'linear-gradient(45deg, #10b981, #059669)';
      
      setTimeout(() => {
        btn.textContent = originalText;
        btn.style.background = '';
      }, 2000);
    }

    // Update unit buttons
    function updateUnitButtons() {
      document.querySelectorAll('.unit-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.unit === currentUnit) {
          btn.classList.add('active');
        }
      });
    }

    // Update statistics
    function updateStats() {
      const currentWeightEl = document.getElementById('currentWeight');
      const startWeightEl = document.getElementById('startWeight');
      const totalChangeEl = document.getElementById('totalChange');
      const totalEntriesEl = document.getElementById('totalEntries');

      if (weightEntries.length === 0) {
        currentWeightEl.textContent = '--';
        startWeightEl.textContent = '--';
        totalChangeEl.textContent = '--';
        totalEntriesEl.textContent = '0';
        return;
      }

      const current = weightEntries[weightEntries.length - 1];
      const start = weightEntries[0];
      const change = current.weight - start.weight;

      currentWeightEl.textContent = `${current.weight} ${current.unit}`;
      startWeightEl.textContent = `${start.weight} ${start.unit}`;
      
      const changeText = change > 0 ? `+${change.toFixed(1)}` : change.toFixed(1);
      totalChangeEl.textContent = `${changeText} ${current.unit}`;
      totalChangeEl.style.color = change > 0 ? '#dc2626' : change < 0 ? '#16a34a' : '#64748b';
      
      totalEntriesEl.textContent = weightEntries.length;
    }

    // Update chart
    function updateChart() {
      if (!window.chartJsLoaded || typeof Chart === 'undefined') {
        return; // Wait until Chart.js is loaded
      }

      // Hide loading overlay
      const loadingOverlay = document.getElementById('loadingOverlay');
      const chartCanvas = document.getElementById('weightChart');
      const chartEmptyState = document.getElementById('chartEmptyState');
      
      if (loadingOverlay) {
        loadingOverlay.style.display = 'none';
      }

      // Show empty state if no entries
      if (weightEntries.length === 0) {
        chartCanvas.style.display = 'none';
        chartEmptyState.style.display = 'block';
        return;
      }

      // Show chart and hide empty state
      chartCanvas.style.display = 'block';
      chartEmptyState.style.display = 'none';

      const ctx = chartCanvas.getContext('2d');

      if (chart) {
        chart.destroy();
      }

      const labels = weightEntries.map(entry => {
        const date = new Date(entry.date);
        return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
      });

      const data = weightEntries.map(entry => entry.weight);

      chart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: [{
            label: `Weight (${currentUnit})`,
            data: data,
            borderColor: '#3b82f6',
            backgroundColor: 'rgba(59, 130, 246, 0.1)',
            borderWidth: 3,
            fill: true,
            tension: 0.4,
            pointBackgroundColor: '#3b82f6',
            pointBorderColor: '#ffffff',
            pointBorderWidth: 2,
            pointRadius: 6,
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: false
            }
          },
          scales: {
            y: {
              beginAtZero: false,
              grid: {
                color: '#f1f5f9'
              },
              ticks: {
                color: '#64748b'
              }
            },
            x: {
              grid: {
                color: '#f1f5f9'
              },
              ticks: {
                color: '#64748b'
              }
            }
          },
          elements: {
            point: {
              hoverBackgroundColor: '#1e40af'
            }
          }
        }
      });
    }

    // Update entries list
    function updateEntriesList() {
      const entriesList = document.getElementById('entriesList');

      if (weightEntries.length === 0) {
        entriesList.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">📊</div>
            <p>No weight entries yet. Add your first weight above!</p>
          </div>
        `;
        return;
      }

      const recentEntries = [...weightEntries].reverse().slice(0, 10);

      const entriesHTML = recentEntries.map((entry, index) => {
        const date = new Date(entry.date).toLocaleDateString('en-US', { 
          weekday: 'short', 
          month: 'short', 
          day: 'numeric' 
        });

        let changeText = '';
        let changeClass = 'neutral';

        if (index < recentEntries.length - 1) {
          const prevEntry = recentEntries[index + 1];
          const change = entry.weight - prevEntry.weight;
          
          if (change !== 0) {
            changeText = change > 0 ? `+${change.toFixed(1)}` : change.toFixed(1);
            changeClass = change > 0 ? 'positive' : 'negative';
          }
        }

        return `
          <div class="entry-item">
            <div class="entry-date">${date}</div>
            <div class="entry-weight">${entry.weight} ${entry.unit}</div>
            ${changeText ? `<div class="entry-change ${changeClass}">${changeText}</div>` : '<div></div>'}
            <button class="delete-btn" onclick="deleteEntry('${entry.date}')">×</button>
          </div>
        `;
      }).join('');

      entriesList.innerHTML = entriesHTML;
    }

    // Delete entry
    function deleteEntry(date) {
      if (confirm('Are you sure you want to delete this entry?')) {
        weightEntries = weightEntries.filter(entry => entry.date !== date);
        saveData();
        updateStats();
        updateChart();
        updateEntriesList();
      }
    }

    // Initialize chart when Chart.js is ready
    window.initChart = function() {
      console.log('Chart.js ready, initializing chart...');
      updateChart();
    };

    // Initialize app immediately when DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
      console.log('DOM loaded, initializing app...');
      
      // Load data and update UI immediately
      loadData();
      
      // Set up event listeners
      document.querySelectorAll('.unit-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          currentUnit = this.dataset.unit;
          updateUnitButtons();
          saveData();
          updateStats();
          updateChart();
          updateEntriesList();
        });
      });

      document.getElementById('weightInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          addWeight();
        }
      });

      // Auto-focus weight input
      document.getElementById('weightInput').focus();
      
      // Try to initialize chart if Chart.js is already loaded
      if (window.chartJsLoaded && typeof Chart !== 'undefined') {
        updateChart();
      }
    });
  </script>
</body>
</html>